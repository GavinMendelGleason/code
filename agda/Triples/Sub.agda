open import Utils
open import Relation.Binary hiding (_â‡’_)
open import Relation.Nullary

module Sub
  (Atom : Set)
  (X : Set)
  (D : Set)
  (eqAtom : DecEq Atom)
  (eqX : DecEq X)
  (eqD : DecEq D)
  (DT : Set)
  (âŠ¢áµŸ_âˆ¶_ : D â†’ DT â†’ Set)
  (typeDec : Decidable (âŠ¢áµŸ_âˆ¶_))
  where

open import Data.String renaming (_â‰Ÿ_ to eqString)
open import Data.List 
import Mu
module MuMod = Mu Atom X D eqAtom eqX eqD DT âŠ¢áµŸ_âˆ¶_ typeDec
open MuMod public
open import FinSet

_â‰²_ : âˆ€ (Ï†â‚ Ï†â‚‚ : Shape) â†’ Set
Ï†â‚ â‰² Ï†â‚‚ = âˆ€ ğ“£ â†’ let db = (ğ““ ğ“£ âˆª ğ“¡â‚› ğ“£) in
                 let interp = (Î» _ â†’ db)
                 in âŸ¦ Ï†â‚ âŸ§ interp db ğ“£ âŠ† âŸ¦ Ï†â‚‚ âŸ§ interp db ğ“£


SâŠ†SâˆªR : âˆ€ S R â†’ S âŠ† (S âˆª R)
SâŠ†SâˆªR [] R x ()
SâŠ†SâˆªR (xâ‚ âˆ· S) R .xâ‚ here = {! !}
SâŠ†SâˆªR (x âˆ· S) R xâ‚ (there xâˆˆS) = {!!} 

âŸ¦Ï†âŸ§âŠ†ğ“¢ : âˆ€ Ï† ğ“£ â†’ âŸ¦ Ï† âŸ§ (Î» _ â†’ ğ““ ğ“£ âˆª ğ“¡â‚› ğ“£) (ğ““ ğ“£ âˆª ğ“¡â‚› ğ“£) ğ“£ âŠ† (ğ““ ğ“£ âˆª ğ“¡â‚› ğ“£)
âŸ¦Ï†âŸ§âŠ†ğ“¢ âŠ¥ ğ“£ = Î» x â†’ Î» ()
âŸ¦Ï†âŸ§âŠ†ğ“¢ âŠ¤ ğ“£ = Î» x xâ‚ â†’ {!!}
âŸ¦Ï†âŸ§âŠ†ğ“¢ (Î±âŸ¨ a âŸ© Ï†) ğ“£ = {!!}
âŸ¦Ï†âŸ§âŠ†ğ“¢ (Î±[ a ] Ï†) ğ“£ = {!!}
âŸ¦Ï†âŸ§âŠ†ğ“¢ (â„“âŸ¨ a âŸ© x) ğ“£ = {!!}
âŸ¦Ï†âŸ§âŠ†ğ“¢ (â„“[ a ] x) ğ“£ = {!!}
âŸ¦Ï†âŸ§âŠ†ğ“¢ (Ï† âŠ• Ï†â‚) ğ“£ = {!!}
âŸ¦Ï†âŸ§âŠ†ğ“¢ (Ï† âŠ— Ï†â‚) ğ“£ = {!!}
âŸ¦Ï†âŸ§âŠ†ğ“¢ (Î½ x Ï†) ğ“£ = {!!}
âŸ¦Ï†âŸ§âŠ†ğ“¢ (v x) ğ“£ = {!!}
âŸ¦Ï†âŸ§âŠ†ğ“¢ (- Ï†) ğ“£ = {!!}

âŠ¥â‰²Ï† : âˆ€ Ï† â†’ âŠ¥ â‰² Ï† 
âŠ¥â‰²Ï† Ï† = Î» ğ“£ x â†’ Î» ()

Ï†â‰²âŠ¤ : âˆ€ Ï† â†’ Ï† â‰² âŠ¤ 
Ï†â‰²âŠ¤ Ï† ğ“£ x âŸ¦Ï†â‚âŸ§ = {!!}

_â‰²?_ : âˆ€ Ï†â‚ Ï†â‚‚ â†’ Dec (Ï†â‚ â‰² Ï†â‚‚)
âŠ¥ â‰²? Ï†â‚‚ = yes (âŠ¥â‰²Ï† Ï†â‚‚)
âŠ¤ â‰²? âŠ¥ = no (Î» x â†’ {!!})
âŠ¤ â‰²? âŠ¤ = yes (Î» ğ“£ x z â†’ z)
âŠ¤ â‰²? (Î±âŸ¨ a âŸ© Ï†â‚‚) = no {!!}
âŠ¤ â‰²? (Î±[ a ] Ï†â‚‚) = no {!!}
âŠ¤ â‰²? (â„“âŸ¨ a âŸ© x) = no {!!}
âŠ¤ â‰²? (â„“[ a ] x) = no {!!}
âŠ¤ â‰²? (Ï†â‚‚ âŠ• Ï†â‚ƒ) = {!!}
âŠ¤ â‰²? (Ï†â‚‚ âŠ— Ï†â‚ƒ) = {!!}
âŠ¤ â‰²? Î½ x Ï†â‚‚ = {!!}
âŠ¤ â‰²? v x = {!!}
âŠ¤ â‰²? (- Ï†â‚‚) = {!!}
(Î±âŸ¨ a âŸ© Ï†) â‰²? Ï†â‚‚ = {!!}
(Î±[ a ] Ï†) â‰²? Ï†â‚‚ = {!!}
(â„“âŸ¨ a âŸ© x) â‰²? Ï†â‚‚ = {!!}
(â„“[ a ] x) â‰²? Ï†â‚‚ = {!!}
(Ï† âŠ• Ï†â‚) â‰²? Ï†â‚‚ = {!!}
(Ï† âŠ— Ï†â‚) â‰²? Ï†â‚‚ = {!!}
Î½ x Ï† â‰²? Ï†â‚‚ = {!!}
v x â‰²? Ï†â‚‚ = {!!}
(- Ï†) â‰²? Ï†â‚‚ = {!!}
